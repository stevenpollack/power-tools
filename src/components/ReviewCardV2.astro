---
import { Picture } from "astro:assets";
import type { ReviewData, AuthorData, ToolData } from "@/lib/types";

interface Props {
  slug: ReviewData["slug"];
  toolId: string;
  toolBrand: ToolData["brand"];
  toolName: ToolData["name"];
  toolImage: ToolData["thumbnailUrl"];
  authorName: AuthorData["name"];
  excerpt: ReviewData["excerpt"];
}

const { slug, toolId, toolBrand, toolName, toolImage, authorName, excerpt } =
  Astro.props;

// Link to tool page with review anchor for deep linking
const reviewUrl = `/tool/${toolId}?review=${slug}`;
---

<a href={reviewUrl} class="review-card-v2 group block w-full text-left">
  <div
    class="border-bunnings-neutral-medium-gray hover:border-bunnings-secondary-green rounded-lg border-2 bg-white p-6 transition-all duration-300 hover:shadow-xl"
  >
    <!-- Tool Image - Centered, prominent with Astro optimization -->
    <div class="mb-4 flex justify-center">
      <Picture
        src={toolImage}
        alt={`${toolBrand} ${toolName}`}
        class="border-bunnings-neutral-light-gray h-20 w-20 rounded-lg border object-cover"
        widths={[80, 160]}
        sizes="80px"
        formats={["avif", "webp"]}
        loading="lazy"
      />
    </div>

    <!-- Tool Identification -->
    <div class="mb-4 text-center">
      <h3
        class="text-bunnings-neutral-charcoal mb-1 line-clamp-2 text-lg font-semibold"
      >
        {toolName}
      </h3>
      <p class="text-bunnings-neutral-medium-gray text-sm">
        {toolBrand}
      </p>
    </div>

    <!-- Review Preview -->
    <p
      class="text-bunnings-neutral-dark-gray mb-4 text-sm leading-relaxed"
    >
      {excerpt}
    </p>

    <!-- Author Credit -->
    <div class="border-bunnings-neutral-light-gray border-t pt-3 text-center">
      <span class="text-bunnings-neutral-medium-gray text-sm">
        by {authorName}
      </span>
    </div>
  </div>
</a>
